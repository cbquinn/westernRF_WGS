

/group/ctbrowngrp2/cbquinn/fox4/slurmscripts/shapeit_phase.sh
```sh
#!/bin/bash -l
#SBATCH --job-name=phase
#SBATCH --array=1-24%15
#SBATCH --time 24:00:00
#SBATCH --mem=4GB
#SBATCH -p bmm
#SBATCH -A ctbrowngrp
#SBATCH -o /group/ctbrowngrp2/cbquinn/fox4/slurmlogs/shapeit_phase_%a.out
#SBATCH -e /group/ctbrowngrp2/cbquinn/fox4/slurmlogs/shapeit_phase_%a.err

conda activate shapeit

BED=/group/ctbrowngrp2/cbquinn/fox4/ref/GCF_018345385.1/autosomes.bed
CHR=$(sed "${SLURM_ARRAY_TASK_ID}q;d" $BED | cut -f1)

cd /group/ctbrowngrp2/cbquinn/fox4/1_vcfs/variant/n34

shapeit4 --input bcf_variant_filterA_ac1.dp3.mis20_n34_masked.vcf.gz --region $CHR --output phased/filterA_${CHR}_phased.vcf.gz --sequencing
```
runs very fast (10 minutes per chr?)

concatenate chromosomes

/group/ctbrowngrp2/cbquinn/fox4/slurmscripts/concat_variant_phased.sh
```sh
#!/bin/bash -l
#SBATCH --job-name=concat
#SBATCH --time 04:00:00
#SBATCH --mem=500M
#SBATCH -p bmm
#SBATCH -A ctbrowngrp
#SBATCH -o /group/ctbrowngrp2/cbquinn/fox4/slurmlogs/concat_variant_phased.out
#SBATCH -e /group/ctbrowngrp2/cbquinn/fox4/slurmlogs/concat_variant_phased.err

start=`date +%s`
echo "My SLURM_ARRAY_TASK_ID: " $SLURM_ARRAY_TASK_ID

# fail on errors and don't allow unset variables
set –o pipefail
set –o errexit
set –o nounset

cd /group/ctbrowngrp2/cbquinn/fox4/1_vcfs/variant/n34/phased

module load bcftools/1.14

# indexes vcf files
FILENAMES=$(ls filterA_*_phased.vcf.gz)
for i in $FILENAMES
do
    bcftools index $i
done

bcftools concat -o bfilterA_phased.vcf.gz -O z ${FILENAMES}
bcftools index bfilterA_phased.vcf.gz

end=`date +%s`
runtime=$((end-start))
echo "finished concatenating:"
echo $runtime
```
 took 22 minutes