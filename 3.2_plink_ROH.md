/group/ctbrowngrp2/cbquinn/fox4/slurmscripts/plink_ROH.sh
```
#!/bin/bash -l
#SBATCH --job-name=plinkroh
#SBATCH --time 1-00:00:00
#SBATCH --mem=3GB
[[3.3_IBS_ROH]]#SBATCH -p bmm
#SBATCH -A ctbrowngrp
#SBATCH -o /group/ctbrowngrp2/cbquinn/fox4/slurmlogs/plink_ROH.out
#SBATCH -e /group/ctbrowngrp2/cbquinn/fox4/slurmlogs/plink_ROH.err

cd /group/ctbrowngrp2/cbquinn/fox4/1_vcfs/variant/n34
OUTDIR=/group/ctbrowngrp2/cbquinn/fox4/3_ROH/plink
INDIR=/group/ctbrowngrp2/cbquinn/fox4/1_vcfs/variant/n34

module load deprecated/plink/1.90

cd $INDIR
for i in $(ls *_masked.vcf.gz)
do
VCF=$i
OUT=${i%.vcf.gz}

# create plink files
plink --vcf $VCF --keep-allele-order --allow-extra-chr --chr-set 24 --recode --out $INDIR/$OUT

# my old parameters
plink --file $INDIR/$OUT \
    --allow-extra-chr \
    --chr-set 24 \
    --homozyg-window-snp 50 \
    --homozyg-window-het 3 \
    --homozyg-window-missing 10 \
    --homozyg-window-threshold 0.05 \
    --homozyg-snp 50 \
    --homozyg-kb 100 \
    --homozyg-density 50 \
    --homozyg-gap 1000 \
    --out $OUTDIR/${OUT}_plink_winsnp50.winhet3.winmis10.winthresh10.hom50.homkb100.homdens50.homgap1000

# my old parameters, slightly tweaked to vary less from vonSeth
plink --file $INDIR/$OUT \
    --allow-extra-chr \
    --chr-set 24 \
    --homozyg-window-snp 50 \
    --homozyg-window-het 3 \
    --homozyg-window-missing 10 \
    --homozyg-window-threshold 0.05 \
    --homozyg-snp 25 \
    --homozyg-kb 100 \
    --homozyg-density 50 \
    --homozyg-gap 1000 \
    --out $OUTDIR/${OUT}_plink_winsnp25.winhet3.winmis10.winthresh10.hom50.homkb100.homdens50.homgap1000

# vonSeth1
plink --file $INDIR/$OUT \
    --allow-extra-chr \
    --chr-set 24 \
    --homozyg-window-snp 100 \
    --homozyg-window-het 1 \
    --homozyg-window-missing 20 \
    --homozyg-window-threshold 0.05 \
    --homozyg-snp 25 \
    --homozyg-kb 100 \
    --homozyg-density 50 \
    --homozyg-gap 1000 \
    --homozyg-het 750 \
    --out $OUTDIR/${OUT}_plink_winsnp100.winhet1.winmis20.winthresh05.hom25.homkb100.homdens50.homgap1000.homhet750
    
# vonSeth2
plink --file $INDIR/$OUT \
    --allow-extra-chr \
    --chr-set 24 \
    --homozyg-window-snp 250 \
    --homozyg-window-het 3 \
    --homozyg-window-missing 20 \
    --homozyg-window-threshold 0.05 \
    --homozyg-snp 25 \
    --homozyg-kb 100 \
    --homozyg-density 50 \
    --homozyg-gap 1000 \
    --homozyg-het 750 \
    --out $OUTDIR/${OUT}_plink_winsnp250.winhet3.winmis20.winthresh05.hom25.homkb100.homdens50.homgap1000.homhet750

# vonSeth3
plink --file $INDIR/$OUT \
    --allow-extra-chr \
    --chr-set 24 \
    --homozyg-window-snp 500 \
    --homozyg-window-het 5 \
    --homozyg-window-missing 20 \
    --homozyg-window-threshold 0.05 \
    --homozyg-snp 25 \
    --homozyg-kb 100 \
    --homozyg-density 50 \
    --homozyg-gap 1000 \
    --homozyg-het 750 \
    --out $OUTDIR/${OUT}_plink_winsnp500.winhet5.winmis20.winthresh05.hom25.homkb100.homdens50.homgap1000.homhet750
    
done
```

> Because ROH identification is sensitive to input parameters, we ran the analysis with three different sets of parameters: a sliding window size of 100, 250 or 500 SNPs (_homozyg-window-snp 100/250/500_); no more than 1, 3 or 5 heterozygous site per window to assume a window as homozygous (_homozyg-window-het 1/3/5_); at least 5% of all windows including a given SNP to define the SNP as being in a homozygous segment (_homozyg-window-threshold 0.05_); a homozygous segment was defined as a ROH if the segment included ≥ 25 SNPs (_homozyg-snp 25_) and covered ≥ 100 kb (_homozyg-kb_ 100); the minimum SNP density was one SNP per 50 kb (_homozyg-density 50_); and the maximum distance between two neighbouring SNPs was ≤ 1,000 kb (_homozyg-gap 1,000_). Finally, we set the value at 750 heterozygous sites within ROH (_homozyg-het 750_) in order to prevent sequencing errors to cut ROH. The inbreeding coefficient FROH was then estimated as the overall proportion of the genome (autosomes only) contained within ROH. The main results are based on: _homozyg-window-het_ 5, _homozyg-window-snp_ 500



## collate results
```
cd /group/ctbrowngrp2/cbquinn/fox4/3_ROH/plink
unset CONDA_EXE
module load R/3.6.3
R
library(tidyverse)
```


    --homozyg-window-snp 50 \
    --homozyg-window-het 3 \
    --homozyg-window-missing 10 \
    --homozyg-snp 50 \
    
    --homozyg-window-threshold 0.05 \
    --homozyg-kb 100 \
    --homozyg-density 50 \
    --homozyg-gap 1000 \
vs
    --homozyg-window-snp 500 \
    --homozyg-window-het 5 \
    --homozyg-window-missing 20 \
    
    --homozyg-snp 25 \
    --homozyg-window-threshold 0.05 \ SAME
    --homozyg-kb 100 \ SAME
    --homozyg-density 50 \ SAME
    --homozyg-gap 1000 \ SAME
    --homozyg-het 750 \