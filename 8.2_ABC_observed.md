
## install easySFS
courtesy of lauren hennely
```
conda create -n easysfs3
conda activate easysfs3
conda install numpy -n easysfs3
conda install dadi -n easysfs3
conda install pandas -n easysfs3
conda activate easysfs3
cd ~/bin
git clone https://github.com/isaacovercast/easySFS.git
cd easySFS
chmod 777 easySFS.py
~/bin/easySFS/easySFS.py
```

### create a pop file

/group/ctbrowngrp2/cbquinn/fox4/8_ABC/observed/popfile.txt
```
ORC_S17-2543	ORC
ORC_S17-2544	ORC
ORC_S18-1173	ORC
ORC_S18-2062	ORC
ORC_S18-2069	ORC
ORC_S18-2071	ORC
RM_S13-0649	RM
RM_S13-1169	RM
RM_S13-2260	RM
RM_S13-2269	RM
RM_S13-3301	RM
RM_S18-2063	RM
```

make this just a list of individuals for subsetting vcf above
```
cd /group/ctbrowngrp2/cbquinn/fox4/8_ABC/observed/
cut -f1 popfile.txt > indfile.txt
```

### get unlinked, neutral, sites that are polymorphic in 2 populations and have no missing data

```
module load bcftools

VCF=/group/ctbrowngrp2/cbquinn/fox4/5_load/snpeff/intergenic_full.vcf.gz

cd /group/ctbrowngrp2/cbquinn/fox4/8_ABC/observed/

bcftools view -S indfileRM_ORC.txt $VCF | \
bcftools view -c 1 | \
bcftools +prune -m 0.1 -e 'F_MISSING>=0.01' -Oz -o RM_ORC_poly_pruned_nomiss.vcf.gz

#22351 snps
```


## get sfs
```
VCF=RM_ORC_poly_pruned_nomiss.vcf.gz
POPS=/group/ctbrowngrp2/cbquinn/fox4/8_ABC/observed/popfileRM_ORC.txt

cd /group/ctbrowngrp2/cbquinn/fox4/8_ABC/observed
conda activate easysfs3

~/bin/easySFS/easySFS.py -i $VCF -p $POPS --proj 12,12 -a -o easySFS_RM_ORC --unfolded

# convert to 1d format
cd /group/ctbrowngrp2/cbquinn/fox4/8_ABC/observed/easySFS_RM_ORC/fastsimcoal2
FILE="RM_ORC_poly_pruned_nomiss_jointDAFpop1_0.obs"
sed '1,2d' ${FILE} | cut -f2- | tr '\n' ' ' | cut -d ' ' -f2- > jsfs_observed.txt
```

